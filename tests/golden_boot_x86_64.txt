limine: Loading kernel `boot:///boot/levitate-kernel`...
limine: Loading module `boot:///boot/initramfs.cpio`...
RikdHeap initialized.
[BOOT] Protocol: Limine
[BOOT] Memory: 16 regions, 1774 MB usable
[BOOT] Stage 2: Memory & MMU (PEI)
[MEM] Reserving initramfs: 0xffff80006ef64000 - 0xffff80006f287e00 (3215 KB)
[MEM] Physical: 0x50000 - 0x6ef44000 (454388 pages, 1774 MB)
[MEM] Frame allocator initialized
[CPU] x86_64 PCR initialized at 0xffffffff80068a50
[SYSCALL] x86_64 syscall MSRs initialized, LSTAR=0xffffffff8004d314
[BOOT] Stage 2: Memory & MMU (PEI)
Exceptions initialized.
[BOOT] Stage 3: Boot Console (DXE)
[PCI] Scanning Bus 0 for GPU...
[PCI] Found VirtIO GPU at 00:02.0
[PCI] PciTransport created successfully
[GPU] Initializing...
[GPU] Attempting VirtIO GPU initialization...
[GPU] Resolution: 1280x800
[GPU] Initialized via VirtIO transport
GPU initialized successfully.
[TERM] GPU resolution: 1280x800
[TERM] Terminal::new(1280x800) -> 128x36 chars (font 10x20, spacing 2)
Terminal initialized.
╔══════════════════════════════════════════════════════════╗
║  [GPU DEBUG] DISPLAY STATUS: HAS CONTENT ✅              ║
║  Non-black pixels: 400 (~0% of screen)            
║  Flush count: 1                                          
╚══════════════════════════════════════════════════════════╝
Core drivers initialized.
Timer initialized.
[BOOT] Stage 4: Discovery & FS (DXE/BDS)
[INPUT] Initializing Input via PCI...
[PCI] Scanning Bus 0 for Input...
[PCI] Found VirtIO Input at 00:03.0
[PCI] PciTransport created successfully
[INPUT] VirtIO Input initialized via PCI.
Detecting Initramfs...
Initramfs found at 0xffff80006ef64000 - 0xffff80006f287e00 (3292672 bytes)
Files in initramfs:
 - .
 - bin
 - bin/busybox
 - bin/hello_dynamic
 - bin/sh
 - bin/ash
 - bin/cat
 - bin/cp
 - bin/echo
 - bin/ls
 - bin/mkdir
 - bin/mv
 - bin/pwd
 - bin/rm
 - bin/rmdir
 - bin/touch
 - bin/ln
 - bin/chmod
 - bin/chown
 - bin/head
 - bin/tail
 - bin/true
 - bin/false
 - bin/test
 - bin/[
 - bin/stat
 - bin/wc
 - bin/grep
 - bin/sed
 - bin/awk
 - bin/sort
 - bin/uniq
 - bin/cut
 - bin/tr
 - bin/tee
 - bin/find
 - bin/xargs
 - bin/which
 - bin/tar
 - bin/gzip
 - bin/gunzip
 - bin/zcat
 - bin/vi
 - bin/ps
 - bin/kill
 - bin/killall
 - bin/sleep
 - bin/mount
 - bin/umount
 - bin/df
 - bin/du
 - bin/date
 - bin/clear
 - bin/reset
 - bin/env
 - bin/printenv
 - bin/uname
 - bin/hostname
 - bin/id
 - bin/whoami
 - sbin
 - sbin/init
 - sbin/halt
 - sbin/poweroff
 - sbin/reboot
 - etc
 - etc/inittab
 - etc/passwd
 - etc/group
 - etc/profile
 - etc/motd
 - proc
 - sys
 - tmp
 - dev
 - root
 - root/hello.txt
 - lib
 - lib/ld-musl-x86_64.so.1
 - init
 - test.sh
 - test-core.sh
[BOOT] Process hooks registered
[BOOT] spawning init task...
ELF Header e_ident verified
[MMU] Creating user page table...
[MMU] Allocated L0 table at phys [MASKED]
[MMU] Zeroing L0 table at va [MASKED]
[ELF] Copying segment: src[0]=7f to VA 400000
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[ELF] Copying segment: src[0]=50 to VA 401000
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[ELF] Copying segment: src[0]=2 to VA 4ef000
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[ELF] Copying segment: src[0]=f0 to VA 521c10
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[TLS] TEAM_408: Allocated TLS at 0x7ffffffe0000
[TASK] UserTask::new: PID=1 Entry=0x4015b5
[SPAWN] Created process PID=1 entry=0x4015b5 sp=0x7ffffffeff30 brk=0x527000
[BOOT] Set FOREGROUND_PID=1
[SCHED] add_task: PID=1
[BOOT] Init process scheduled.
Mounting filesystems...
[FS] Filesystem subsystem ready
[BOOT] Filesystem initialized successfully.
[BOOT] Mounted tmpfs at /tmp
[BOOT] Mounted tmpfs at /root
[DEVTMPFS] Initialized with null, zero, full, urandom, console devices
[BOOT] Mounted devtmpfs at /dev
[GPU_TEST] Flush count: 119
[GPU_TEST] Framebuffer: 400 non-black pixels of 1024000 total

[SUCCESS] LevitateOS System Ready.
--------------------------------------
[TASK_EXIT] PID 0 marked Exited, calling schedule()
[SWITCH] old PID=0 -> new PID=1
[SWITCH] To PID=1: ctx.rsp=0xffffffff8046e000, ctx.rip=0xffffffff8004d438, ctx.rbx=0xffffffff8003ae20
[SWITCH] Frame at rsp: rcx=0x0, rsp=0x0, rax=0x2
[SWITCH] Raw at offset 56: 0x0, at offset 120: 0x0
[TASK] Entering user task PID=1 at 0x4015b5 (wrapper fn=0xffffffff8003ae20, exception_return=0xffffffff8004d3c0)
[TASK] Setting FS_BASE=0x7ffffffe0000 for PID=1
[TASK] Calling enter_user_mode(0x4015b5, 0x7ffffffeff30)
[SYSCALL] PID=1 nr=158 args=[0x1002, 0x526278, 0xe7, 0xffffffff8046ef50]
[SYSCALL] arch_prctl(code=0x1002, addr=0x526278)
[SYSCALL] PID=1 nr=218 args=[0x526b6c, 0x526278, 0xe7, 0xffffffff8046ef50]
[SYSCALL] PID=1 nr=102 args=[0x7ffffffeffe7, 0x2f, 0x0, 0xffffffff8046ef50]
[SYSCALL] PID=1 nr=14 args=[0x0, 0x5265d8, 0x0, 0x8]
[SYSCALL] PID=1 nr=39 args=[0x0, 0x5265d8, 0x0, 0x8]
[SYSCALL] PID=1 nr=169 args=[0xfee1dead, 0x28121969, 0x0, 0x8]
[REBOOT] CAD_OFF - Ctrl+Alt+Del disabled
[SYSCALL] PID=1 nr=2 args=[0x50160d, 0x8002, 0x0, 0x0]
[SYSCALL] PID=1 nr=3 args=[0x3, 0x0, 0x0, 0x0]
[SYSCALL] PID=1 nr=16 args=[0x0, 0x5600, 0x7ffffffefd8c, 0x0]
[SYSCALL] PID=1 nr=12 args=[0x0, 0x7fffffff0000, 0xc, 0x0]
[SYSCALL] PID=1 nr=12 args=[0x529000, 0x7fffffff0000, 0xc, 0x0]
[SYSCALL] PID=1 nr=9 args=[0x0, 0x2000, 0x0, 0x22]
[MMAP] Request: addr=0x0 len=0x2000 prot=0x0 flags=0x22
[MMAP] Found free region at 0x100000000000
[MMAP] Mapped 2 pages at 0x100000000000 with prot=0x0
[SYSCALL] PID=1 nr=10 args=[0x100000001000, 0x1000, 0x3, 0x22]
[MPROTECT] Changed protection for 1 pages at 0x100000001000-0x100000002000 prot=0x3
[SYSCALL] PID=1 nr=9 args=[0x0, 0x1000, 0x3, 0x22]
[MMAP] Request: addr=0x0 len=0x1000 prot=0x3 flags=0x22
[MMAP] Found free region at 0x100000002000
[MMAP] Mapped 1 pages at 0x100000002000 with prot=0x3
[SYSCALL] PID=1 nr=16 args=[0x0, 0x5401, 0x7ffffffefd2c, 0x10000000221c]
[SYSCALL] PID=1 nr=16 args=[0x0, 0x5402, 0x7ffffffefd2c, 0x10000000221c]
[SYSCALL] PID=1 nr=80 args=[0x50d89d, 0x5402, 0x7ffffffefd2c, 0x10000000221c]
[SYSCALL] PID=1 nr=112 args=[0x0, 0x5402, 0x4ced42, 0x10000000221c]
[SYSCALL] PID=1 nr=2 args=[0x50fee7, 0x8000, 0x1b6, 0x50ff6d]
[SYSCALL] PID=1 nr=9 args=[0x0, 0x1000, 0x3, 0x22]
[MMAP] Request: addr=0x0 len=0x1000 prot=0x3 flags=0x22
[MMAP] Found free region at 0x100000003000
[MMAP] Mapped 1 pages at 0x100000003000 with prot=0x3
[SYSCALL] PID=1 nr=0 args=[0x3, 0x100000003120, 0x400, 0x2]
[SYSCALL] PID=1 nr=0 args=[0x3, 0x100000003120, 0x400, 0x100000003394]
[SYSCALL] PID=1 nr=3 args=[0x3, 0x100000003520, 0x0, 0x100000003394]
[SYSCALL] PID=1 nr=11 args=[0x100000003000, 0x1000, 0x1000, 0x2]
[MUNMAP] Unmapped 0x100000003000-0x100000004000
[SYSCALL] PID=1 nr=14 args=[0x1, 0x7ffffffefd40, 0x0, 0x8]
[SYSCALL] PID=1 nr=13 args=[0x14, 0x7ffffffefd20, 0x0, 0x8]
[SYSCALL] PID=1 nr=13 args=[0x13, 0x7ffffffefd20, 0x0, 0x8]
[SYSCALL] PID=1 nr=58 args=[0x100000002490, 0x7ffffffefd20, 0x4b9fd0, 0x8]
[SYSCALL] clone: fork mode (no CLONE_VM)
[FORK] Creating fork of PID=1
[FORK] Parent frame: rcx=0x4d5d54, rsp=0x7ffffffefd10, rax=0x3a
[FORK] Copying user address space...
[MMU] Creating user page table...
[MMU] Allocated L0 table at phys [MASKED]
[MMU] Zeroing L0 table at va [MASKED]
[FORK] VMA 1: 0x400000-0x401000 flags=VmaFlags(READ | WRITE | EXEC)
[FORK] VMA 2: 0x401000-0x4ef000 flags=VmaFlags(READ | EXEC)
[FORK] VMA 3: 0x4ef000-0x521000 flags=VmaFlags(READ | WRITE | EXEC)
[FORK] VMA 4: 0x521000-0x527000 flags=VmaFlags(READ | WRITE | EXEC)
[FORK] VMA 5: 0x100000000000-0x100000001000 flags=VmaFlags(0x0)
[FORK] VMA 6: 0x100000001000-0x100000002000 flags=VmaFlags(READ | WRITE)
[FORK] VMA 7: 0x100000002000-0x100000003000 flags=VmaFlags(READ | WRITE)
[FORK] VMA 8: 0x7ffffff70000-0x7fffffff0000 flags=VmaFlags(READ | WRITE)
[FORK] Address space copy complete, child_ttbr0=0x6eab5000, 426 pages copied
[FORK] Copied address space, child_ttbr0=0x6eab5000
[FORK] Child frame at 0xffffffff80473620: rcx=0x4d5d54, rsp=0x7ffffffefd10
[FORK] Frame readback: rcx=0x4d5d54, rsp=0x7ffffffefd10, rax=0x0
[FORK] Child PID=2
[FORK] Context setup: rsp=0xffffffff80473620, rip=0xffffffff8004d438, rbx=0xffffffff8004d3c0
[FORK] Created child TCB: PID=2, ttbr0=0x6eab5000, entry=0x4d5d54
[FORK] refresh_kernel_mappings: current CR3=0xb67000, child=0x6eab5000
[FORK] PML4[511] after refresh: parent=0x7fe74000, child=0x7fe74000
[SCHED] add_task: PID=2
[SYSCALL] clone: forked process PID=2 from parent PID=1
[SYSCALL] PID=1 nr=61 args=[0xffffffffffffffff, 0x0, 0x0, 0x0]
[SWITCH] old PID=1 -> new PID=2
[SWITCH] To PID=2: ctx.rsp=0xffffffff80473620, ctx.rip=0xffffffff8004d438, ctx.rbx=0xffffffff8004d3c0
[SWITCH] Frame at rsp: rcx=0x4d5d54, rsp=0x7ffffffefd10, rax=0x0
[SWITCH] Raw at offset 56: 0x4d5d54, at offset 120: 0x7ffffffefd10
[SYSCALL] PID=2 nr=13 args=[0x13, 0x7ffffffefb20, 0x7ffffffefb40, 0x8]
[SYSCALL] PID=2 nr=13 args=[0x14, 0x7ffffffefb20, 0x7ffffffefb40, 0x8]
[SYSCALL] PID=2 nr=14 args=[0x1, 0x7ffffffefc68, 0x7ffffffefc68, 0x8]
[SYSCALL] PID=2 nr=112 args=[0x1, 0x7ffffffefc68, 0x0, 0x8]
[SYSCALL] setsid() -> 2
[SYSCALL] PID=2 nr=16 args=[0x0, 0x5401, 0x7ffffffefcac, 0x8]
[SYSCALL] PID=2 nr=16 args=[0x0, 0x5402, 0x7ffffffefcac, 0x8]
[SYSCALL] PID=2 nr=39 args=[0x0, 0x5402, 0x7ffffffefcac, 0x8]
[SYSCALL] PID=2 nr=41 args=[0x1, 0x80002, 0x0, 0x0]
[SYSCALL] socket(domain=1, type=524290, protocol=0) -> EAFNOSUPPORT
[SYSCALL] PID=2 nr=228 args=[0x0, 0x7ffffffef590, 0x0, 0x0]
[SYSCALL] PID=2 nr=44 args=[0xffffffffffffffff, 0x7ffffffef630, 0x61, 0x0]
[SYSCALL] sendto(sockfd=-1, len=97) -> ENOTSOCK
[SYSCALL] PID=2 nr=3 args=[0xffffffffffffffff, 0x0, 0x0, 0x0]
[SYSCALL] PID=2 nr=59 args=[0x50fe2b, 0x7ffffffefba0, 0x100000002230, 0x5076f0]
[SYSCALL] execve('/bin/sh', argv=0x7ffffffefba0, envp=0x100000002230)
ELF Header e_ident verified
[MMU] Creating user page table...
[MMU] Allocated L0 table at phys [MASKED]
[MMU] Zeroing L0 table at va [MASKED]
[ELF] Copying segment: src[0]=7f to VA 400000
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[ELF] Copying segment: src[0]=50 to VA 401000
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[ELF] Copying segment: src[0]=2 to VA 4ef000
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[ELF] Copying segment: src[0]=f0 to VA 521c10
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[TLS] TEAM_408: Allocated TLS at 0x7ffffffe0000
[EXEC] Prepared image: entry=0x4015b5 sp=0x7ffffffefe70 brk=0x527000 tls=0x7ffffffe0000
[EXECVE] Success: path='/bin/sh' entry=0x4015b5 sp=0x7ffffffefe70
[SYSCALL] PID=2 nr=158 args=[0x1002, 0x526278, 0xe7, 0x0]
[SYSCALL] arch_prctl(code=0x1002, addr=0x526278)
[SYSCALL] PID=2 nr=218 args=[0x526b6c, 0x526278, 0xe7, 0x0]
[SYSCALL] PID=2 nr=102 args=[0x7ffffffeff4f, 0x2f, 0x7ffffffeff54, 0x0]
[SYSCALL] PID=2 nr=12 args=[0x0, 0x7fffffff0000, 0xc, 0x0]
[SYSCALL] PID=2 nr=12 args=[0x529000, 0x7fffffff0000, 0xc, 0x0]
[SYSCALL] PID=2 nr=9 args=[0x0, 0x2000, 0x0, 0x22]
[MMAP] Request: addr=0x0 len=0x2000 prot=0x0 flags=0x22
[MMAP] Found free region at 0x100000000000
[MMAP] Mapped 2 pages at 0x100000000000 with prot=0x0
[SYSCALL] PID=2 nr=10 args=[0x100000001000, 0x1000, 0x3, 0x22]
[MPROTECT] Changed protection for 1 pages at 0x100000001000-0x100000002000 prot=0x3
[SYSCALL] PID=2 nr=9 args=[0x0, 0x1000, 0x3, 0x22]
[MMAP] Request: addr=0x0 len=0x1000 prot=0x3 flags=0x22
[MMAP] Found free region at 0x100000002000
[MMAP] Mapped 1 pages at 0x100000002000 with prot=0x3
[SYSCALL] PID=2 nr=9 args=[0x0, 0x1000, 0x3, 0x22]
[MMAP] Request: addr=0x0 len=0x1000 prot=0x3 flags=0x22
[MMAP] Found free region at 0x100000003000
[MMAP] Mapped 1 pages at 0x100000003000 with prot=0x3
[SYSCALL] PID=2 nr=39 args=[0x1000000023b0, 0x100000003e8c, 0x466570, 0x100000003fec]
[SYSCALL] PID=2 nr=14 args=[0x1, 0x7ffffffef9e0, 0x0, 0x8]
[SYSCALL] PID=2 nr=13 args=[0x11, 0x7ffffffef9c0, 0x0, 0x8]
[SYSCALL] PID=2 nr=9 args=[0x0, 0x1000, 0x3, 0x22]
[MMAP] Request: addr=0x0 len=0x1000 prot=0x3 flags=0x22
[MMAP] Found free region at 0x100000004000
[MMAP] Mapped 1 pages at 0x100000004000 with prot=0x3
[SYSCALL] PID=2 nr=110 args=[0x51dfc5, 0x51dfc4, 0x4, 0x10000000421c]
[SYSCALL] PID=2 nr=63 args=[0x7ffffffefb80, 0x10000000412c, 0x0, 0x0]
[SYSCALL] uname() -> 0
[SYSCALL] PID=2 nr=79 args=[0x7ffffffeecd0, 0x1000, 0x0, 0x10000000460c]
[SYSCALL] PID=2 nr=13 args=[0x2, 0x0, 0x7ffffffefc10, 0x8]
[SYSCALL] PID=2 nr=13 args=[0x2, 0x7ffffffefbf0, 0x0, 0x8]
[SYSCALL] PID=2 nr=13 args=[0x3, 0x0, 0x7ffffffefc10, 0x8]
[SYSCALL] PID=2 nr=13 args=[0x3, 0x7ffffffefbf0, 0x0, 0x8]
[SYSCALL] PID=2 nr=13 args=[0xf, 0x0, 0x7ffffffefc10, 0x8]
[SYSCALL] PID=2 nr=13 args=[0x3, 0x7ffffffef780, 0x0, 0x8]
[SYSCALL] PID=2 nr=59 args=[0x100000003178, 0x1000000031e0, 0x1000000031f8, 0x8]
[SYSCALL] execve('/bin/echo', argv=0x1000000031e0, envp=0x1000000031f8)
ELF Header e_ident verified
[MMU] Creating user page table...
[MMU] Allocated L0 table at phys [MASKED]
[MMU] Zeroing L0 table at va [MASKED]
[ELF] Copying segment: src[0]=7f to VA 400000
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[ELF] Copying segment: src[0]=50 to VA 401000
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[ELF] Copying segment: src[0]=2 to VA 4ef000
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[ELF] Copying segment: src[0]=f0 to VA 521c10
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[TLS] TEAM_408: Allocated TLS at 0x7ffffffe0000
[EXEC] Prepared image: entry=0x4015b5 sp=0x7ffffffefe60 brk=0x527000 tls=0x7ffffffe0000
[EXECVE] Success: path='/bin/echo' entry=0x4015b5 sp=0x7ffffffefe60
[SYSCALL] PID=2 nr=158 args=[0x1002, 0x526278, 0xe7, 0x0]
[SYSCALL] arch_prctl(code=0x1002, addr=0x526278)
[SYSCALL] PID=2 nr=218 args=[0x526b6c, 0x526278, 0xe7, 0x0]
[SYSCALL] PID=2 nr=102 args=[0x7ffffffeff4f, 0x2f, 0x7ffffffeff54, 0x0]
[SYSCALL] PID=2 nr=12 args=[0x0, 0x7fffffff0000, 0xc, 0x0]
[SYSCALL] PID=2 nr=12 args=[0x529000, 0x7fffffff0000, 0xc, 0x0]
[SYSCALL] PID=2 nr=9 args=[0x0, 0x2000, 0x0, 0x22]
[MMAP] Request: addr=0x0 len=0x2000 prot=0x0 flags=0x22
[MMAP] Found free region at 0x100000000000
[MMAP] Mapped 2 pages at 0x100000000000 with prot=0x0
[SYSCALL] PID=2 nr=10 args=[0x100000001000, 0x1000, 0x3, 0x22]
[MPROTECT] Changed protection for 1 pages at 0x100000001000-0x100000002000 prot=0x3
[SYSCALL] PID=2 nr=9 args=[0x0, 0x1000, 0x3, 0x22]
[MMAP] Request: addr=0x0 len=0x1000 prot=0x3 flags=0x22
[MMAP] Found free region at 0x100000002000
[MMAP] Mapped 1 pages at 0x100000002000 with prot=0x3
[SYSCALL] PID=2 nr=1 args=[0x1, 0x100000002040, 0x21, 0x0]
LevitateOS (BusyBox) starting...
[SYSCALL] PID=2 nr=11 args=[0x100000002000, 0x1000, 0x1000, 0x1]
[MUNMAP] Unmapped 0x100000002000-0x100000003000
[SYSCALL] PID=2 nr=231 args=[0x0, 0x0, 0x0, 0x1]
[SYSCALL] exit_group(0)
[SYSCALL] exit(0)
[SCHED] add_task: PID=1
[TASK_EXIT] PID 2 marked Exited, calling schedule()
[SWITCH] old PID=2 -> new PID=1
[SWITCH] To PID=1: ctx.rsp=0xffffffff8046dbf8, ctx.rip=0xffffffff8004d312, ctx.rbx=0xffffffff80473930
[SWITCH] Frame at rsp: rcx=0xffffffff80057e79, rsp=0xffffffff8046dcc0, rax=0xffffffff8003b6b6
[SWITCH] Raw at offset 56: 0xffffffff80057e79, at offset 120: 0xffffffff8046dcc0
[SYSCALL] PID=1 nr=21 args=[0x5108a6, 0x6, 0x0, 0x0]
[SYSCALL] faccessat(dirfd=-100, path='/dev/null/utmp', mode=0x6, flags=0x0)
[SYSCALL] PID=1 nr=2 args=[0x5108a6, 0x8041, 0x1b4, 0x0]
[SYSCALL] PID=1 nr=3 args=[0xffffffffffffffff, 0x0, 0x0, 0x0]
[SYSCALL] PID=1 nr=58 args=[0x1000000024f0, 0x0, 0x4b9fd0, 0x0]
[SYSCALL] clone: fork mode (no CLONE_VM)
[FORK] Creating fork of PID=1
[FORK] Parent frame: rcx=0x4d5d54, rsp=0x7ffffffefd10, rax=0x3a
[FORK] Copying user address space...
[MMU] Creating user page table...
[MMU] Allocated L0 table at phys [MASKED]
[MMU] Zeroing L0 table at va [MASKED]
[FORK] VMA 1: 0x400000-0x401000 flags=VmaFlags(READ | WRITE | EXEC)
[FORK] VMA 2: 0x401000-0x4ef000 flags=VmaFlags(READ | EXEC)
[FORK] VMA 3: 0x4ef000-0x521000 flags=VmaFlags(READ | WRITE | EXEC)
[FORK] VMA 4: 0x521000-0x527000 flags=VmaFlags(READ | WRITE | EXEC)
[FORK] VMA 5: 0x100000000000-0x100000001000 flags=VmaFlags(0x0)
[FORK] VMA 6: 0x100000001000-0x100000002000 flags=VmaFlags(READ | WRITE)
[FORK] VMA 7: 0x100000002000-0x100000003000 flags=VmaFlags(READ | WRITE)
[FORK] VMA 8: 0x7ffffff70000-0x7fffffff0000 flags=VmaFlags(READ | WRITE)
[FORK] Address space copy complete, child_ttbr0=0x122c000, 426 pages copied
[FORK] Copied address space, child_ttbr0=0x122c000
[FORK] Child frame at 0xffffffff80478588: rcx=0x4d5d54, rsp=0x7ffffffefd10
[FORK] Frame readback: rcx=0x4d5d54, rsp=0x7ffffffefd10, rax=0x0
[FORK] Child PID=3
[FORK] Context setup: rsp=0xffffffff80478588, rip=0xffffffff8004d438, rbx=0xffffffff8004d3c0
[FORK] Created child TCB: PID=3, ttbr0=0x122c000, entry=0x4d5d54
[FORK] refresh_kernel_mappings: current CR3=0xb67000, child=0x122c000
[FORK] PML4[511] after refresh: parent=0x7fe74000, child=0x7fe74000
[SCHED] add_task: PID=3
[SYSCALL] clone: forked process PID=3 from parent PID=1
[SYSCALL] PID=1 nr=61 args=[0xffffffffffffffff, 0x0, 0x0, 0x0]
[SWITCH] old PID=1 -> new PID=3
[SWITCH] To PID=3: ctx.rsp=0xffffffff80478588, ctx.rip=0xffffffff8004d438, ctx.rbx=0xffffffff8004d3c0
[SWITCH] Frame at rsp: rcx=0x4d5d54, rsp=0x7ffffffefd10, rax=0x0
[SWITCH] Raw at offset 56: 0x4d5d54, at offset 120: 0x7ffffffefd10
[SYSCALL] PID=3 nr=13 args=[0x13, 0x7ffffffefb20, 0x7ffffffefb40, 0x8]
[SYSCALL] PID=3 nr=13 args=[0x14, 0x7ffffffefb20, 0x7ffffffefb40, 0x8]
[SYSCALL] PID=3 nr=14 args=[0x1, 0x7ffffffefc68, 0x7ffffffefc68, 0x8]
[SYSCALL] PID=3 nr=112 args=[0x1, 0x7ffffffefc68, 0x0, 0x8]
[SYSCALL] setsid() -> 3
[SYSCALL] PID=3 nr=16 args=[0x0, 0x5401, 0x7ffffffefcac, 0x8]
[SYSCALL] PID=3 nr=16 args=[0x0, 0x5402, 0x7ffffffefcac, 0x8]
[SYSCALL] PID=3 nr=39 args=[0x0, 0x5402, 0x7ffffffefcac, 0x8]
[SYSCALL] PID=3 nr=41 args=[0x1, 0x80002, 0x0, 0x0]
[SYSCALL] socket(domain=1, type=524290, protocol=0) -> EAFNOSUPPORT
[SYSCALL] PID=3 nr=228 args=[0x0, 0x7ffffffef590, 0x0, 0x0]
[SYSCALL] PID=3 nr=44 args=[0xffffffffffffffff, 0x7ffffffef630, 0x52, 0x0]
[SYSCALL] sendto(sockfd=-1, len=82) -> ENOTSOCK
[SYSCALL] PID=3 nr=3 args=[0xffffffffffffffff, 0x0, 0x0, 0x0]
[SYSCALL] PID=3 nr=59 args=[0x7ffffffefc80, 0x7ffffffefbf0, 0x100000002230, 0x5076f0]
[SYSCALL] execve('/bin/mount', argv=0x7ffffffefbf0, envp=0x100000002230)
ELF Header e_ident verified
[MMU] Creating user page table...
[MMU] Allocated L0 table at phys [MASKED]
[MMU] Zeroing L0 table at va [MASKED]
[ELF] Copying segment: src[0]=7f to VA 400000
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[ELF] Copying segment: src[0]=50 to VA 401000
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[ELF] Copying segment: src[0]=2 to VA 4ef000
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[ELF] Copying segment: src[0]=f0 to VA 521c10
[ELF] Resolved PA [MASKED] -> Kernel VA [MASKED]
[TLS] TEAM_408: Allocated TLS at 0x7ffffffe0000
[EXEC] Prepared image: entry=0x4015b5 sp=0x7ffffffefe70 brk=0x527000 tls=0x7ffffffe0000
[EXECVE] Success: path='/bin/mount' entry=0x4015b5 sp=0x7ffffffefe70
[SYSCALL] PID=3 nr=158 args=[0x1002, 0x526278, 0xe7, 0x0]
[SYSCALL] arch_prctl(code=0x1002, addr=0x526278)
[SYSCALL] PID=3 nr=218 args=[0x526b6c, 0x526278, 0xe7, 0x0]
[SYSCALL] PID=3 nr=102 args=[0x7ffffffeff67, 0x2f, 0x7ffffffeff6c, 0x0]
[SYSCALL] PID=3 nr=12 args=[0x0, 0x7fffffff0000, 0xc, 0x0]
[SYSCALL] PID=3 nr=12 args=[0x529000, 0x7fffffff0000, 0xc, 0x0]
[SYSCALL] PID=3 nr=9 args=[0x0, 0x2000, 0x0, 0x22]
[MMAP] Request: addr=0x0 len=0x2000 prot=0x0 flags=0x22
[MMAP] Found free region at 0x100000000000
[MMAP] Mapped 2 pages at 0x100000000000 with prot=0x0
[SYSCALL] PID=3 nr=10 args=[0x100000001000, 0x1000, 0x3, 0x22]
[MPROTECT] Changed protection for 1 pages at 0x100000001000-0x100000002000 prot=0x3
[SYSCALL] PID=3 nr=9 args=[0x0, 0x1000, 0x3, 0x22]
[MMAP] Request: addr=0x0 len=0x1000 prot=0x3 flags=0x22
[MMAP] Found free region at 0x100000002000
[MMAP] Mapped 1 pages at 0x100000002000 with prot=0x3
[SYSCALL] PID=3 nr=102 args=[0x100000002041, 0x10000000204c, 0x0, 0x10000000221c]
[SYSCALL] PID=3 nr=107 args=[0x100000002041, 0x10000000204c, 0x0, 0x10000000221c]
[SYSCALL] PID=3 nr=4 args=[0x7ffffffeff88, 0x7ffffffefaf0, 0x7ffffffefaf0, 0x52532c]
[SYSCALL] PID=3 nr=165 args=[0x7ffffffeff88, 0x7ffffffeff90, 0x7ffffffeff80, 0x8000]
[SYSCALL] PID=3 nr=231 args=[0x0, 0x0, 0x2c, 0x8000]
[SYSCALL] exit_group(0)
[SYSCALL] exit(0)
[SCHED] add_task: PID=1
[TASK_EXIT] PID 3 marked Exited, calling schedule()
[SWITCH] old PID=3 -> new PID=1
[SWITCH] To PID=1: ctx.rsp=0xffffffff8046dbf8, ctx.rip=0xffffffff8004d312, ctx.rbx=0xffffffff80478880
[SWITCH] Frame at rsp: rcx=0xffffffff80057e79, rsp=0xffffffff8046dcc0, rax=0xffffffff8003b6b6
[SWITCH] Raw at offset 56: 0xffffffff80057e79, at offset 120: 0xffffffff8046dcc0
[SYSCALL] PID=1 nr=21 args=[0x5108a6, 0x6, 0x0, 0x0]
[SYSCALL] faccessat(dirfd=-100, path='/dev/null/utmp', mode=0x6, flags=0x0)
[SYSCALL] PID=1 nr=2 args=[0x5108a6, 0x8041, 0x1b4, 0x0]
[SYSCALL] PID=1 nr=3 args=[0xffffffffffffffff, 0x0, 0x0, 0x0]
[SYSCALL] PID=1 nr=58 args=[0x100000002550, 0x0, 0x4b9fd0, 0x0]
[SYSCALL] clone: fork mode (no CLONE_VM)
[FORK] Creating fork of PID=1
[FORK] Parent frame: rcx=0x4d5d54, rsp=0x7ffffffefd10, rax=0x3a
[FORK] Copying user address space...
[MMU] Creating user page table...
[MMU] Allocated L0 table at phys [MASKED]
[MMU] Zeroing L0 table at va [MASKED]
[FORK] VMA 1: 0x400000-0x401000 flags=VmaFlags(READ | WRITE | EXEC)
[FORK] VMA 2: 0x401000-0x4ef000 flags=VmaFlags(READ | EXEC)
[FORK] VMA 3: 0x4ef000-0x521000 flags=VmaFlags(READ | WRITE | EXEC)
[FORK] VMA 4: 0x521000-0x527000 flags=VmaFlags(READ | WRITE | EXEC)
[FORK] VMA 5: 0x100000000000-0x100000001000 flags=VmaFlags(0x0)
[FORK] VMA 6: 0x100000001000-0x100000002000 flags=VmaFlags(READ | WRITE)
[FORK] VMA 7: 0x100000002000-0x100000003000 flags=VmaFlags(READ | WRITE)
[FORK] VMA 8: 0x7ffffff70000-0x7fffffff0000 flags=VmaFlags(READ | WRITE)
[FORK] Address space copy complete, child_ttbr0=0x1ac1000, 426 pages copied
[FORK] Copied address space, child_ttbr0=0x1ac1000
[FORK] Child frame at 0xffffffff8047d620: rcx=0x4d5d54, rsp=0x7ffffffefd10
[FORK] Frame readback: rcx=0x4d5d54, rsp=0x7ffffffefd10, rax=0x0
[FORK] Child PID=4
[FORK] Context setup: rsp=0xffffffff8047d620, rip=0xffffffff8004d438, rbx=0xffffffff8004d3c0
[FORK] Created child TCB: PID=4, ttbr0=0x1ac1000, entry=0x4d5d54
[FORK] refresh_kernel_mappings: current CR3=0xb67000, child=0x1ac1000
[FORK] PML4[511] after refresh: parent=0x7fe74000, child=0x7fe74000
[SCHED] add_task: PID=4
[SYSCALL] clone: forked process PID=4 from parent PID=1
[SYSCALL] PID=1 nr=61 args=[0xffffffffffffffff, 0x0, 0x0, 0x0]
[SWITCH] old PID=1 -> new PID=4
[SWITCH] To PID=4: ctx.rsp=0xffffffff8047d620, ctx.rip=0xffffffff8004d438, ctx.rbx=0xffffffff8004d3c0
[SWITCH] Frame at rsp: rcx=0x4d5d54, rsp=0x7ffffffefd10, rax=0x0
[SWITCH] Raw at offset 56: 0x4d5d54, at offset 120: 0x7ffffffefd10
[SYSCALL] PID=4 nr=13 args=[0x13, 0x7ffffffefb20, 0x7ffffffefb40, 0x8]
[SYSCALL] PID=4 nr=13 args=[0x14, 0x7ffffffefb20, 0x7ffffffefb40, 0x8]
[SYSCALL] PID=4 nr=14 args=[0x1, 0x7ffffffefc68, 0x7ffffffefc68, 0x8]
[SYSCALL] PID=4 nr=112 args=[0x1, 0x7ffffffefc68, 0x0, 0x8]
[SYSCALL] setsid() -> 4
[SYSCALL] PID=4 nr=16 args=[0x0, 0x5401, 0x7ffffffefcac, 0x8]
[SYSCALL] PID=4 nr=16 args=[0x0, 0x5402, 0x7ffffffefcac, 0x8]
[SYSCALL] PID=4 nr=39 args=[0x0, 0x5402, 0x7ffffffefcac, 0x8]
