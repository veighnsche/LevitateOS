; seatd - Minimal seat management daemon
; https://git.sr.ht/~kennylevinsen/seatd

(package "seatd" "0.8.0"
  (description "Minimal seat management daemon")
  (license "MIT")
  (homepage "https://git.sr.ht/~kennylevinsen/seatd")

  (deps
    (build "meson" "ninja" "pkg-config" "scdoc"))

  (acquire
    (source "https://git.sr.ht/~kennylevinsen/seatd/archive/0.8.0.tar.gz"
      (sha256 "TODO")))

  (build
    (configure "meson setup build --prefix=$PREFIX \
      -Dlibseat-logind=disabled \
      -Dlibseat-seatd=enabled \
      -Dlibseat-builtin=enabled \
      -Dserver=enabled")
    (compile "ninja -C build -j$NPROC"))

  (install
    (shell "DESTDIR=$DESTDIR ninja -C build install"))

  (configure
    (create-user "seatd" system no-login)
    (create-group "seat")
    (create-dir "/run/seatd" "seatd"))

  (start
    (service systemd "seatd"))

  (cleanup sources))
